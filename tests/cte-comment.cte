c0
{
    "type" = {
        "identifier" = "ce-test"
        "version" = 1
    }
    "ceversion" = 0
    "tests" = [

        // ====================================================================

        {
            "name" = "Comment basic structure"
            "mustSucceed" = [
                {
                    "events" = ["cs=" "n=1"]
                    "cte" = "\.^
//
1^"
                }
                {
                    "events" = ["cs=test" "n=1"]
                    "cte" = "\.^
//test
1^"
                }
                {
                    "events" = ["cs= test" "n=1"]
                    "cte" = "\.^
// test
1^"
                }
                {
                    "events" = ["cs= test " "n=1"]
                    "cte" = "\.^
// test 
1^"
                }
                {
                    "events" = ["cs= /* test */" "n=1"]
                    "cte" = "\.^
// /* test */
1^"
                }
                {
                    "events" = ["cm=" "n=1"]
                    "cte" = "\.^
/**/
1^"
                }
                {
                    "events" = ["cm=test" "n=1"]
                    "cte" = "\.^
/*test*/
1^"
                }
                {
                    "events" = ["cm= test " "n=1"]
                    "cte" = "\.^
/* test */
1^"
                }
                {
                    "events" = ["cm= test\nmultiline" "n=1"]
                    "cte" = "\.^
/* test
multiline*/
1^"
                }
                {
                    "events" = ["cm= test /* nested */ " "n=1"]
                    "cte" = "\.^
/* test /* nested */ */
1^"
                }
                {
                    "events" = ["cm=/**/" "n=1"]
                    "cte" = "\.^
/*/**/*/
1^"
                }
                {
                    "events" = ["cm=/*/**/*/" "n=1"]
                    "cte" = "\.^
/*/*/**/*/*/
1^"
                }
                {
                    "events" = ["cm= a /* b /* c */ d */ e " "n=1"]
                    "cte" = "\.^
/* a /* b /* c */ d */ e */
1^"
                }
                {
                    "events" = ["cm= test // nested " "n=1"]
                    "cte" = "\.^
/* test // nested */
1^"
                }
                {
                    "events" = ["cm= test\n/* nested */\n" "n=1"]
                    "cte" = "\.^
/* test
/* nested */
*/
1^"
                }
                {
                    "events" = ["cm= test\n// nested\n" "n=1"]
                    "cte" = "\.^
/* test
// nested
*/
1^"
                }
                {"cte"="//\r\n1"  "events"=["cs=" "n=1"] "lossyCTE"=true}
                {"cte"="// \r\n1"  "events"=["cs= " "n=1"] "lossyCTE"=true}
                {"cte"="// test\r\n1"  "events"=["cs= test" "n=1"] "lossyCTE"=true}
                {
                    "cte" = "\.^
/* x */1^"
                    "events" = ["cm= x " "n=1"]
                    "lossyCTE"=true
                }
                {
                    "cte" = "\.^
/* x */ 1^"
                    "events" = ["cm= x " "n=1"]
                    "lossyCTE"=true
                }
            ]
            "mustFail" = [
                {"cte"="//"}             // No content
                {"cte"="/*"}             // Unterminated
                {"cte"="/**"}            // Unterminated
                {"cte"="/*/"}            // Unterminated
                {"cte"="/*/**/"}         // Unterminated
                {"cte"="/* /* */"}       // Unterminated
                {"cte"="/* /* /* */ */"} // Unterminated
                {"cte"="1//"}            // Comment after TLO
                {"cte"="1/**/"}          // Comment after TLO
            ]
        }

        // ====================================================================

        {
            "name" = "Comment positioning (list)"
            "encodeDecode" = [
                {
                    "events" = ["l" "cs= x" "e"]
                    "cte" = "\.^
[
    // x
]^"
                }
                {
                    "events" = ["l" "cm= x " "e"]
                    "cte" = "\.^
[
    /* x */
]^"
                }
                {
                    "events" = ["l" "cs= x" "s=abc" "e"]
                    "cte" = "\.^
[
    // x
    "abc"
]^"
                }
                {
                    "events" = ["l" "cm= x " "s=abc" "e"]
                    "cte" = "\.^
[
    /* x */
    "abc"
]^"
                }
                {
                    "events" = ["l" "s=abc" "cs= x" "e"]
                    "cte" = "\.^
[
    "abc"
    // x
]^"
                }
                {
                    "events" = ["l" "s=abc" "cm= x " "e"]
                    "cte" = "\.^
[
    "abc"
    /* x */
]^"
                }
            ]
            "decodeEncode" = [
/* TODO: Allow "abc"// x
                {
                    "cte" = "\.^
[
    "abc"// x
]^"
                    "events" = ["l" "s=abc" "cs= x" "e"]
                }
*/
                {
                    "cte" = "\.^
[
    "abc" // x
]^"
                    "events" = ["l" "s=abc" "cs= x" "e"]
                }
                {
                    "cte" = "\.^
[
    "abc" /* x */
]^"
                    "events" = ["l" "s=abc" "cm= x " "e"]
                }
/* TODO: Allow "abc"/* x */
                {
                    "cte" = "\.^
[
    "abc"/* x */
]^"
                    "events" = ["l" "s=abc" "cm= x " "e"]
                }
*/
                {
                    "cte" = "\.^
[
    /* x */ "abc"
]^"
                    "events" = ["l" "cm= x " "s=abc" "e"]
                }
            ]
        }

        // ====================================================================

        {
            "name" = "Comment positioning (map)"
            "encodeDecode" = [
                {
                    "events" = ["m" "cs= x" "e"]
                    "cte" = "\.^
{
    // x
}^"
                }
                {
                    "events" = ["m" "cm= x " "e"]
                    "cte" = "\.^
{
    /* x */
}^"
                }
                {
                    "events" = ["m" "cs= x" "s=abc" "n=1" "e"]
                    "cte" = "\.^
{
    // x
    "abc" = 1
}^"
                }
                {
                    "events" = ["m" "cm= x " "s=abc" "n=1" "e"]
                    "cte" = "\.^
{
    /* x */
    "abc" = 1
}^"
                }
                {
                    "events" = ["m" "s=abc" "n=1" "cs= x" "e"]
                    "cte" = "\.^
{
    "abc" = 1
    // x
}^"
                }
                {
                    "events" = ["m" "s=abc" "n=1" "cm= x " "e"]
                    "cte" = "\.^
{
    "abc" = 1
    /* x */
}^"
                }
                {
                    "events" = ["m" "s=abc" "cs= x" "n=1" "e"]
                    "cte" = "\.^
{
    "abc" = // x
    1
}^"
                }
                {
                    "events" = ["m" "s=abc" "cm= x " "n=1" "e"]
                    "cte" = "\.^
{
    "abc" = /* x */
    1
}^"
                }
            ]
            "decodeEncode" = [
/* TODO: Allow "abc"// x
                {
                    "cte" = "\.^
{
    "abc"// x
    = 1
}^"
                    "events" = ["m" "s=abc" "cs= x" "n=1" "e"]
                }
*/
/* TODO: Allow comment between key and value
                {
                    "cte" = "\.^
{
    "abc" // x
    = 1
}^"
                    "events" = ["m" "s=abc" "cs= x" "n=1" "e"]
                }
*/
                {
                    "cte" = "\.^
{
    "abc" = // x
    1
}^"
                    "events" = ["m" "s=abc" "cs= x" "n=1" "e"]
                }
/* TODO: Allow comment between key and value
                {
                    "cte" = "\.^
{
    "abc" /* x */
    = 1
}^"
                    "events" = ["m" "s=abc" "cm= x " "n=1" "e"]
                }
*/
                {
                    "cte" = "\.^
{
    "abc" = /* x */
    1
}^"
                    "events" = ["m" "s=abc" "cm= x " "n=1" "e"]
                }
/* TODO: Allow "abc"/* x */
                {
                    "cte" = "\.^
{
    "abc"/* x */
    = 1
}^"
                    "events" = ["m" "s=abc" "cm= x " "n=1" "e"]
                }
*/
                {
                    "cte" = "\.^
{
    /* x */ "abc" = 1
}^"
                    "events" = ["m" "cm= x " "s=abc" "n=1" "e"]
                }
            ]
        }

        // ====================================================================

        {
            "name" = "Comment positioning (edge)"
            "encodeDecode" = [
                {
                    "events" = ["l" "edge" "cs= x" "n=1" "n=2" "n=3" "e" "e"]
                    "cte" = "\.^
[
    @(
        // x
        1
        2
        3
    )
]^"
                }
                {
                    "events" = ["l" "edge" "cm= x " "n=1" "n=2" "n=3" "e" "e"]
                    "cte" = "\.^
[
    @(
        /* x */
        1
        2
        3
    )
]^"
                }
                {
                    "events" = ["l" "edge" "n=1" "cs= x" "n=2" "n=3" "e" "e"]
                    "cte" = "\.^
[
    @(
        1
        // x
        2
        3
    )
]^"
                }
                {
                    "events" = ["l" "edge" "n=1" "cm= x " "n=2" "n=3" "e" "e"]
                    "cte" = "\.^
[
    @(
        1
        /* x */
        2
        3
    )
]^"
                }
                {
                    "events" = ["l" "edge" "n=1" "n=2" "cs= x" "n=3" "e" "e"]
                    "cte" = "\.^
[
    @(
        1
        2
        // x
        3
    )
]^"
                }
                {
                    "events" = ["l" "edge" "n=1" "n=2" "cm= x " "n=3" "e" "e"]
                    "cte" = "\.^
[
    @(
        1
        2
        /* x */
        3
    )
]^"
                }
            ]
        }

        // ====================================================================

        {
            "name" = "Comment positioning (node)"
            "encodeDecode" = [
                {
                    "events" = ["l" "node" "cs= x" "n=1" "e" "e"]
                    "cte" = "\.^
[
    (// x
        1
    )
]^"
                }
                {
                    "events" = ["l" "node" "n=1" "cs= x" "e" "e"]
                    "cte" = "\.^
[
    (1
        // x
    )
]^"
                }
                {
                    "events" = ["l" "node" "n=1" "cs= x" "n=2" "n=3" "e" "e"]
                    "cte" = "\.^
[
    (1
        // x
        2
        3
    )
]^"
                }
                {
                    "events" = ["l" "node" "n=1" "n=2" "cs= x" "n=3" "e" "e"]
                    "cte" = "\.^
[
    (1
        2
        // x
        3
    )
]^"
                }
            ]
        }

        // ====================================================================

        {
            "name" = "Complex comment"
            "encodeDecode" = [
                {
                    "events" = ["cm="
                                    "m"
                                        "cm="
                                        "s=a" "cm=" "s=b"
                                        "cm="
                                    "e"]
                    "cte" = "\.^
/**/
{
    /**/
    "a" = /**/
    "b"
    /**/
}^"
                }
            ]
        }

        // ====================================================================

    ]
}
